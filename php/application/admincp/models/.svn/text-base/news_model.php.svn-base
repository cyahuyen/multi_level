<?php

class News_Model extends CI_Model {

    var $tbl = 'news';
    var $id = 'news_id';

    public function __construct() {
        parent::__construct();
    }

    function addNew($data) {

        $this->db->query("INSERT INTO " . $this->tbl . " SET title='" . $data['title'] . "',description='" . html_escape($data['description']) . "',file_path='" . $data['file_path'] . "',type='" . $data['type'] . "',status='" . $data['status'] . "',date=NOW()");

        return $this->db->insert_id();
    }

    function editNew($id, $data) {
        $this->db->query("UPDATE " . $this->tbl . " SET title='" . $data['title'] . "',description='" . html_escape($data['description']) . "',file_path='" . $data['file_path'] . "',type='" . $data['type'] . "',status='" . $data['status'] . "',date=NOW() WHERE news_id='" . (int) $id . "'");
    }

    function deleteNew($id) {
        $this->db->where($this->id, $id);

        $this->db->delete($this->tbl);
    }

    public function getNews() {
        $sql = 'SELECT * FROM ' . $this->tbl;

        $sql.=" ORDER BY news_id DESC";

        if (isset($data['start']) || isset($data['limit'])) {
            if ($data['start'] < 0) {
                $data['start'] = 0;
            }

            if ($data['limit'] < 1) {
                $data['limit'] = 20;
            }

            $sql .= " LIMIT " . (int) $data['start'] . "," . (int) $data['limit'];
        }

        $data = $this->db->query($sql)->result();

        return $data;
    }

    function totalNews() {
        return $this->db->count_all_results($this->tbl);
    }

    public function getNew($id) {
        $query = $this->db->get_where($this->tbl, array('news_id' => $id))->result();

        if ($query) {
            return $query[0];
        } else {
            return false;
        }
    }

}

?>
